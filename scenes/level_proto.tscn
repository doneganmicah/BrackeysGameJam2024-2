[gd_scene load_steps=25 format=4 uid="uid://c7t6obuvy83ui"]

[ext_resource type="PackedScene" uid="uid://cj77wxhaj87aq" path="res://scenes/player.tscn" id="1_03mbu"]
[ext_resource type="Script" path="res://scripts/game_controller.gd" id="1_jutxf"]
[ext_resource type="Texture2D" uid="uid://ce2dm51tinu22" path="res://assets/placeholder_assets/LevelBlocking.png" id="2_kjxbd"]
[ext_resource type="PackedScene" uid="uid://ckif30bwjtonq" path="res://scenes/hazards/hazard_water_leak.tscn" id="3_rvoox"]
[ext_resource type="PackedScene" uid="uid://beyt4jksujctr" path="res://scenes/interactables/breaker_box_interactable.tscn" id="5_1ocpd"]
[ext_resource type="PackedScene" uid="uid://ctthnbjjb2muc" path="res://scenes/interactables/router_interactable.tscn" id="6_d2he6"]
[ext_resource type="PackedScene" path="res://scenes/interactables/door_interactable.tscn" id="7_scnk1"]
[ext_resource type="Material" uid="uid://xnrvsceye8mn" path="res://assets/shaders/animated_surge_material.tres" id="8_avnke"]
[ext_resource type="Texture2D" uid="uid://duoxsvtj131ky" path="res://assets/surge_test_tex.png" id="8_wpqcj"]
[ext_resource type="Texture2D" uid="uid://brkkob21aolxk" path="res://assets/surge_test_sheet.png" id="10_livgt"]

[sub_resource type="Environment" id="Environment_ir1o5"]
background_mode = 3
glow_enabled = true
glow_blend_mode = 1

[sub_resource type="Gradient" id="Gradient_npgfg"]
offsets = PackedFloat32Array(0.140562, 1)
colors = PackedColorArray(1, 1, 1, 1, 0, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_3uwqy"]
gradient = SubResource("Gradient_npgfg")
width = 256
height = 256
fill = 1
fill_from = Vector2(0.487179, 0.512821)
fill_to = Vector2(0.034188, 0.0213675)

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_kpago"]
texture = ExtResource("2_kjxbd")
0:0/0 = 0
0:0/0/z_index = 20
0:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(2, -5, 8, -5, 8, 8, 2, 8)
1:0/0 = 0
1:0/0/z_index = 1
1:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-8, -5, 8, -5, 8, 0, -8, 0)
2:0/0 = 0
2:0/0/z_index = 20
2:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-8, -5, -2, -5, -2, 8, -8, 8)
0:1/0 = 0
0:1/0/z_index = 20
0:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(2, -8, 8, -8, 8, 8, 2, 8)
1:1/0 = 0
2:1/0 = 0
2:1/0/z_index = 20
2:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(-8, -8, -2, -8, -2, 8, -8, 8)
0:2/0 = 0
0:2/0/z_index = 20
0:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(2, -8, 8, -8, 8, 5, 2, 5)
1:2/0 = 0
1:2/0/z_index = 20
1:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(-8, -4.5, 8, -4.5, 8, 5, -8, 5)
2:2/0 = 0
2:2/0/z_index = 20
2:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(-8, -8, -2, -8, -2, 5, -8, 5)

[sub_resource type="TileSet" id="TileSet_ccmty"]
physics_layer_0/collision_layer = 1
sources/0 = SubResource("TileSetAtlasSource_kpago")

[sub_resource type="GDScript" id="GDScript_tcg43"]
script/source = "extends Timer
"

[sub_resource type="AtlasTexture" id="AtlasTexture_8ykaw"]
atlas = ExtResource("10_livgt")
region = Rect2(0, 0, 128, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_7b8qy"]
atlas = ExtResource("10_livgt")
region = Rect2(128, 0, 128, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_v7vcr"]
atlas = ExtResource("10_livgt")
region = Rect2(256, 0, 128, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_s3c7a"]
atlas = ExtResource("10_livgt")
region = Rect2(384, 0, 128, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_jk4b2"]
atlas = ExtResource("10_livgt")
region = Rect2(512, 0, 128, 16)

[sub_resource type="SpriteFrames" id="SpriteFrames_xx0ac"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_8ykaw")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_7b8qy")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_v7vcr")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_s3c7a")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_jk4b2")
}],
"loop": true,
"name": &"default",
"speed": 0.0
}]

[sub_resource type="Curve2D" id="Curve2D_kvxl8"]
_data = {
"points": PackedVector2Array(-26.1434, -52.2867, 26.1434, 52.2867, 100, -38, -12.5992, -45.1997, 12.5992, 45.1997, 98, 74)
}
point_count = 2

[sub_resource type="GDScript" id="GDScript_b56vx"]
resource_name = "path_test"
script/source = "extends Path2D

@export var line : Line2D
@export var sprites : AnimatedSprite2D
var textures = []
var index = 0
var counter = 0

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	for point in self.curve.get_baked_points():
		line.add_point(point + self.position)
	 # Replace with function body.

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _physics_process(delta: float) -> void:
	pass
"

[node name="LevelProto" type="Node2D"]
y_sort_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_ir1o5")

[node name="DirectionalLight2D" type="DirectionalLight2D" parent="WorldEnvironment"]
color = Color(0.787551, 0.86201, 0.491636, 1)
blend_mode = 1

[node name="PointLight2D" type="PointLight2D" parent="WorldEnvironment"]
position = Vector2(-3.93391e-06, 4.5)
scale = Vector2(0.757813, 0.683594)
energy = 1.4
blend_mode = 2
texture = SubResource("GradientTexture2D_3uwqy")

[node name="Player" parent="." instance=ExtResource("1_03mbu")]

[node name="Camera2D" type="Camera2D" parent="."]
zoom = Vector2(5, 5)

[node name="TileMapLayer" type="TileMapLayer" parent="."]
z_index = 1
tile_map_data = PackedByteArray("AAD7/wQAAAABAAIAAAD8/wQAAAABAAIAAAD9/wQAAAABAAIAAAD+/wQAAAABAAIAAAD//wQAAAABAAIAAAAAAAQAAAABAAIAAAABAAQAAAABAAIAAAACAAQAAAABAAIAAAADAAQAAAABAAIAAAAEAAQAAAABAAIAAAD7//3/AAABAAEAAAD7//7/AAABAAEAAAD7////AAABAAEAAAD7/wAAAAABAAEAAAD7/wEAAAABAAEAAAD7/wIAAAABAAEAAAD7/wMAAAABAAEAAAD8//3/AAABAAEAAAD8//7/AAABAAEAAAD8////AAABAAEAAAD8/wAAAAABAAEAAAD8/wEAAAABAAEAAAD8/wIAAAABAAEAAAD8/wMAAAABAAEAAAD9//3/AAABAAEAAAD9//7/AAABAAEAAAD9////AAABAAEAAAD9/wAAAAABAAEAAAD9/wEAAAABAAEAAAD9/wIAAAABAAEAAAD9/wMAAAABAAEAAAD+//3/AAABAAEAAAD+//7/AAABAAEAAAD+////AAABAAEAAAD+/wAAAAABAAEAAAD+/wEAAAABAAEAAAD+/wIAAAABAAEAAAD+/wMAAAABAAEAAAD///3/AAABAAEAAAD///7/AAABAAEAAAD/////AAABAAEAAAD//wAAAAABAAEAAAD//wEAAAABAAEAAAD//wIAAAABAAEAAAD//wMAAAABAAEAAAAAAP3/AAABAAEAAAAAAP7/AAABAAEAAAAAAP//AAABAAEAAAAAAAAAAAABAAEAAAAAAAEAAAABAAEAAAAAAAIAAAABAAEAAAAAAAMAAAABAAEAAAABAP3/AAABAAEAAAABAP7/AAABAAEAAAABAP//AAABAAEAAAABAAAAAAABAAEAAAABAAEAAAABAAEAAAABAAIAAAABAAEAAAABAAMAAAABAAEAAAACAP3/AAABAAEAAAACAP7/AAABAAEAAAACAP//AAABAAEAAAACAAAAAAABAAEAAAACAAEAAAABAAEAAAACAAIAAAABAAEAAAACAAMAAAABAAEAAAADAP3/AAABAAEAAAADAP7/AAABAAEAAAADAP//AAABAAEAAAADAAAAAAABAAEAAAADAAEAAAABAAEAAAADAAIAAAABAAEAAAADAAMAAAABAAEAAAAEAP3/AAABAAEAAAAEAP7/AAABAAEAAAAEAP//AAABAAEAAAAEAAAAAAABAAEAAAAEAAEAAAABAAEAAAAEAAIAAAABAAEAAAAEAAMAAAABAAEAAAD6//z/AAAAAAAAAAAFAPz/AAACAAAAAAD7//z/AAABAAAAAAD8//z/AAABAAAAAAD9//z/AAABAAAAAAD+//z/AAABAAAAAAD///z/AAABAAAAAAAAAPz/AAABAAAAAAABAPz/AAABAAAAAAACAPz/AAABAAAAAAADAPz/AAABAAAAAAAEAPz/AAABAAAAAAAFAP3/AAACAAEAAAAFAP7/AAACAAEAAAAFAP//AAACAAEAAAAFAAAAAAACAAEAAAAFAAEAAAACAAEAAAAFAAIAAAACAAEAAAAFAAMAAAACAAEAAAD6//3/AAAAAAEAAAD6//7/AAAAAAEAAAD6////AAAAAAEAAAD6/wAAAAAAAAEAAAD6/wEAAAAAAAEAAAD6/wIAAAAAAAEAAAD6/wMAAAAAAAEAAAD6/wQAAAAAAAIAAAAFAAQAAAACAAIAAAA=")
tile_set = SubResource("TileSet_ccmty")

[node name="Layout" type="Node" parent="."]

[node name="Kitchen" type="Polygon2D" parent="Layout"]
z_index = 1
position = Vector2(-48, -35)
scale = Vector2(3.1, 1.2)
color = Color(0.517647, 0, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Carpet" type="Polygon2D" parent="Layout"]
z_index = 2
position = Vector2(0, 8)
scale = Vector2(4.7, 2.3)
color = Color(0.517647, 0, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 9.19758, 10, 10, -10, 10)

[node name="BackDoor" type="Polygon2D" parent="Layout"]
z_index = 2
position = Vector2(24, -40)
scale = Vector2(2.3, 0.7)
color = Color(0.517647, 0, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="FrontDoor" type="Polygon2D" parent="Layout"]
z_index = 2
position = Vector2(-72, 48)
scale = Vector2(0.7, 1.5)
color = Color(0.517647, 0, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Interactions" type="Node" parent="."]

[node name="Laptop" type="Polygon2D" parent="Interactions"]
z_index = 2
position = Vector2(0, 56)
scale = Vector2(1, 0.5)
color = Color(0, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Bucket" type="Polygon2D" parent="Interactions"]
z_index = 2
position = Vector2(26, 10)
scale = Vector2(0.6, 0.6)
color = Color(0, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Hazards" type="Node" parent="."]

[node name="PatioDoor" type="Polygon2D" parent="Hazards"]
z_index = 2
position = Vector2(24, -44)
scale = Vector2(1.55, 0.3)
color = Color(1, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Breaker" type="Polygon2D" parent="Hazards"]
z_index = 2
position = Vector2(-78.5, 8)
scale = Vector2(0.55, 0.7)
color = Color(1, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Router" type="Polygon2D" parent="Hazards"]
z_index = 2
position = Vector2(71.75, -40)
scale = Vector2(0.725, 0.7)
color = Color(1, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="PowerStrips" type="Node" parent="Hazards"]

[node name="Strip1" type="Polygon2D" parent="Hazards/PowerStrips"]
z_index = 2
position = Vector2(-50, 14)
rotation = -0.590766
scale = Vector2(0.125, 0.35)
color = Color(1, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Strip2" type="Polygon2D" parent="Hazards/PowerStrips"]
z_index = 2
position = Vector2(-24, -17)
rotation = -0.157832
scale = Vector2(0.125, 0.35)
color = Color(1, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Strip3" type="Polygon2D" parent="Hazards/PowerStrips"]
z_index = 2
position = Vector2(44, -15)
rotation = 0.37193
scale = Vector2(0.125, 0.35)
color = Color(1, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="Strip4" type="Polygon2D" parent="Hazards/PowerStrips"]
z_index = 2
position = Vector2(51, 22)
rotation = 0.67993
scale = Vector2(0.125, 0.35)
color = Color(1, 0.654902, 0, 1)
polygon = PackedVector2Array(-10, -10, 10, -10, 10, 10, -10, 10)

[node name="GameHandler" type="Node" parent="." node_paths=PackedStringArray("_player", "_interval_timer", "haz_water_leak", "haz_electrical_outage", "haz_signal_integrity", "haz_door_open", "time_txt", "perc_txt")]
script = ExtResource("1_jutxf")
attempt_leak_min = 20
attempt_leak_max = 60
attempt_strike_min = 5
outage_chance = 10
attempt_door_min = 20
attempt_door_max = 60
_player = NodePath("../Player")
_interval_timer = NodePath("Timer")
haz_water_leak = NodePath("../HazardWaterLeak")
haz_electrical_outage = NodePath("../breaker_box_interactable")
haz_signal_integrity = NodePath("../router_interactable")
haz_door_open = NodePath("../door_interactable")
time_txt = NodePath("Control/Label")
perc_txt = NodePath("Control/Label2")

[node name="Timer" type="Timer" parent="GameHandler"]
script = SubResource("GDScript_tcg43")

[node name="Control" type="Control" parent="GameHandler"]
layout_mode = 3
anchors_preset = 0
offset_left = 16.0
offset_top = 17.0
offset_right = 23.0
offset_bottom = 40.0

[node name="Label" type="Label" parent="GameHandler/Control"]
layout_mode = 0
offset_left = -182.0
offset_top = -70.0
offset_right = -131.0
offset_bottom = -47.0
text = "{Time}"

[node name="Label2" type="Label" parent="GameHandler/Control"]
layout_mode = 0
offset_left = -184.0
offset_top = -46.0
offset_right = -91.0
offset_bottom = 32.0
text = "{perc}"

[node name="HazardWaterLeak" parent="." instance=ExtResource("3_rvoox")]
position = Vector2(0, 3)
time_till_puddle_kills = 20
time_till_puddle_recesses = 35

[node name="breaker_box_interactable" parent="." node_paths=PackedStringArray("game_controller", "main_light") instance=ExtResource("5_1ocpd")]
y_sort_enabled = true
position = Vector2(-76, 14)
game_controller = NodePath("../GameHandler")
main_light = NodePath("../WorldEnvironment/PointLight2D")

[node name="router_interactable" parent="." node_paths=PackedStringArray("game_controller") instance=ExtResource("6_d2he6")]
position = Vector2(72, -45)
game_controller = NodePath("../GameHandler")

[node name="door_interactable" parent="." node_paths=PackedStringArray("game_controller") instance=ExtResource("7_scnk1")]
z_index = 9
position = Vector2(24, -63)
time_till_puddle_kills = 20
game_controller = NodePath("../GameHandler")

[node name="Line2D" type="Line2D" parent="."]
z_index = 20
texture_repeat = 2
material = ExtResource("8_avnke")
scale = Vector2(1.024, 1)
width = 5.0
default_color = Color(1, 1, 0.00392157, 1)
texture = ExtResource("8_wpqcj")
texture_mode = 1

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="Line2D"]
visible = false
texture_repeat = 2
sprite_frames = SubResource("SpriteFrames_xx0ac")
frame_progress = 0.984565

[node name="Path2D" type="Path2D" parent="." node_paths=PackedStringArray("line", "sprites")]
z_index = 9
position = Vector2(-102, 0)
scale = Vector2(1.024, 1)
curve = SubResource("Curve2D_kvxl8")
script = SubResource("GDScript_b56vx")
line = NodePath("../Line2D")
sprites = NodePath("../Line2D/AnimatedSprite2D")

[connection signal="timeout" from="GameHandler/Timer" to="GameHandler" method="_on_timer_timeout"]
